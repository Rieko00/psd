
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Project 3 Prediksi Saham Multivariate Multistep &#8212; Proyek Sain Data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Saham_mult';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Project 2 Prediksi Saham Univariate" href="Saham_uni.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Proyek Sain Data - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Proyek Sain Data - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Selamat datang
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="predict_cuaca.html">Project 1 Prediksi Cuaca Daerah Surabaya Multivariate</a></li>
<li class="toctree-l1"><a class="reference internal" href="Saham_uni.html">Project 2 Prediksi Saham Univariate</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Project 3 Prediksi Saham Multivariate Multistep</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Rieko00/psd" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Rieko00/psd/issues/new?title=Issue%20on%20page%20%2FSaham_mult.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Saham_mult.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Project 3 Prediksi Saham Multivariate Multistep</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-library">Import Library</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#info-data">Info Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#null-value">Null Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-date-format">Set date format</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-data">Histogram Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot-data">Boxplot Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#corellation-matrix">Corellation Matrix</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepocessing">Prepocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-feature">Select Feature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-data-lag">Create Data Lag</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data">Split Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling-data">Modelling Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy">Deploy</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="project-3-prediksi-saham-multivariate-multistep">
<h1>Project 3 Prediksi Saham Multivariate Multistep<a class="headerlink" href="#project-3-prediksi-saham-multivariate-multistep" title="Link to this heading">#</a></h1>
<section id="import-library">
<h2>Import Library<a class="headerlink" href="#import-library" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingRegressor</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">dump</span><span class="p">,</span> <span class="n">load</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="eda">
<h2>EDA<a class="headerlink" href="#eda" title="Link to this heading">#</a></h2>
<section id="load-data">
<h3>Load Data<a class="headerlink" href="#load-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/BMRI_mult.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Vol</th>
      <th>Change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1459</th>
      <td>12/03/2018</td>
      <td>7600</td>
      <td>7550</td>
      <td>7725</td>
      <td>7550</td>
      <td>68.34M</td>
      <td>2.70%</td>
    </tr>
    <tr>
      <th>1458</th>
      <td>12/04/2018</td>
      <td>7650</td>
      <td>7575</td>
      <td>7650</td>
      <td>7550</td>
      <td>30.08M</td>
      <td>0.66%</td>
    </tr>
    <tr>
      <th>1457</th>
      <td>12/05/2018</td>
      <td>7575</td>
      <td>7600</td>
      <td>7600</td>
      <td>7525</td>
      <td>36.66M</td>
      <td>-0.98%</td>
    </tr>
    <tr>
      <th>1456</th>
      <td>12/06/2018</td>
      <td>7475</td>
      <td>7400</td>
      <td>7525</td>
      <td>7400</td>
      <td>37.05M</td>
      <td>-1.32%</td>
    </tr>
    <tr>
      <th>1455</th>
      <td>12/07/2018</td>
      <td>7500</td>
      <td>7575</td>
      <td>7625</td>
      <td>7475</td>
      <td>20.85M</td>
      <td>0.33%</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="info-data">
<h3>Info Data<a class="headerlink" href="#info-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1460 entries, 1459 to 0
Data columns (total 7 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   Date    1460 non-null   object
 1   Price   1460 non-null   int64 
 2   Open    1460 non-null   int64 
 3   High    1460 non-null   int64 
 4   Low     1460 non-null   int64 
 5   Vol     1460 non-null   object
 6   Change  1460 non-null   object
dtypes: int64(4), object(3)
memory usage: 80.0+ KB
</pre></div>
</div>
</div>
</div>
</section>
<section id="null-value">
<h3>Null Value<a class="headerlink" href="#null-value" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Date      0
Price     0
Open      0
High      0
Low       0
Vol       0
Change    0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-date-format">
<h3>Set date format<a class="headerlink" href="#set-date-format" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">dayfirst</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Change&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Change&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Vol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;e6&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;e9&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Vol</th>
      <th>Change</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-12-03</th>
      <td>7600</td>
      <td>7550</td>
      <td>7725</td>
      <td>7550</td>
      <td>68340000.0</td>
      <td>2.70</td>
    </tr>
    <tr>
      <th>2018-12-04</th>
      <td>7650</td>
      <td>7575</td>
      <td>7650</td>
      <td>7550</td>
      <td>30080000.0</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>2018-12-05</th>
      <td>7575</td>
      <td>7600</td>
      <td>7600</td>
      <td>7525</td>
      <td>36660000.0</td>
      <td>-0.98</td>
    </tr>
    <tr>
      <th>2018-12-06</th>
      <td>7475</td>
      <td>7400</td>
      <td>7525</td>
      <td>7400</td>
      <td>37050000.0</td>
      <td>-1.32</td>
    </tr>
    <tr>
      <th>2018-12-07</th>
      <td>7500</td>
      <td>7575</td>
      <td>7625</td>
      <td>7475</td>
      <td>20850000.0</td>
      <td>0.33</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-02</th>
      <td>6000</td>
      <td>6175</td>
      <td>6250</td>
      <td>5975</td>
      <td>114560000.0</td>
      <td>-2.44</td>
    </tr>
    <tr>
      <th>2024-12-03</th>
      <td>6275</td>
      <td>6100</td>
      <td>6275</td>
      <td>6100</td>
      <td>99510000.0</td>
      <td>4.58</td>
    </tr>
    <tr>
      <th>2024-12-04</th>
      <td>6375</td>
      <td>6275</td>
      <td>6450</td>
      <td>6225</td>
      <td>75260000.0</td>
      <td>1.59</td>
    </tr>
    <tr>
      <th>2024-12-05</th>
      <td>6150</td>
      <td>6350</td>
      <td>6375</td>
      <td>6150</td>
      <td>69530000.0</td>
      <td>-3.53</td>
    </tr>
    <tr>
      <th>2024-12-06</th>
      <td>6225</td>
      <td>6200</td>
      <td>6275</td>
      <td>6125</td>
      <td>75990000.0</td>
      <td>1.22</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="plot-data">
<h3>Plot Data<a class="headerlink" href="#plot-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Harga Saham BMRI&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga dalam rupiah&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tahun&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">([</span><span class="s2">&quot;#2419ef&quot;</span><span class="p">,</span> <span class="s2">&quot;#19c4ef&quot;</span><span class="p">,</span> <span class="s2">&quot;#EF5919&quot;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/daec20bc18a6fbb89f1fd2c87e0f5d057f8986c16a33d0fe328c9a75e4bdebde.png" src="_images/daec20bc18a6fbb89f1fd2c87e0f5d057f8986c16a33d0fe328c9a75e4bdebde.png" />
</div>
</div>
</section>
<section id="histogram-data">
<h3>Histogram Data<a class="headerlink" href="#histogram-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Vol&#39;</span><span class="p">,</span> <span class="s1">&#39;Change&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[&lt;Axes: title={&#39;center&#39;: &#39;Open&#39;}&gt;,
        &lt;Axes: title={&#39;center&#39;: &#39;High&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Low&#39;}&gt;, &lt;Axes: title={&#39;center&#39;: &#39;Vol&#39;}&gt;],
       [&lt;Axes: title={&#39;center&#39;: &#39;Change&#39;}&gt;, &lt;Axes: &gt;]], dtype=object)
</pre></div>
</div>
<img alt="_images/bdea176c349706ec0882f72ccaa5a3f46895b41562c15dce45c7f2df4b15b4c9.png" src="_images/bdea176c349706ec0882f72ccaa5a3f46895b41562c15dce45c7f2df4b15b4c9.png" />
</div>
</div>
</section>
<section id="boxplot-data">
<h3>Boxplot Data<a class="headerlink" href="#boxplot-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/26dc5ff8532e31ff66a11b563d9db7aecd9156530118ee8b074cc40144ba52aa.png" src="_images/26dc5ff8532e31ff66a11b563d9db7aecd9156530118ee8b074cc40144ba52aa.png" />
</div>
</div>
</section>
<section id="corellation-matrix">
<h3>Corellation Matrix<a class="headerlink" href="#corellation-matrix" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           Price      Open      High       Low       Vol    Change
Price   1.000000  0.997671  0.998930  0.998896 -0.262281  0.036160
Open    0.997671  1.000000  0.998872  0.998815 -0.263644 -0.010878
High    0.998930  0.998872  1.000000  0.998448 -0.253346  0.012897
Low     0.998896  0.998815  0.998448  1.000000 -0.270512  0.012472
Vol    -0.262281 -0.263644 -0.253346 -0.270512  1.000000  0.016278
Change  0.036160 -0.010878  0.012897  0.012472  0.016278  1.000000
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/5bb062c53701f30aeddece3a1aef0354fdcebd524fa8ae9ac570efa6e6452164.png" src="_images/5bb062c53701f30aeddece3a1aef0354fdcebd524fa8ae9ac570efa6e6452164.png" />
</div>
</div>
</section>
</section>
<section id="prepocessing">
<h2>Prepocessing<a class="headerlink" href="#prepocessing" title="Link to this heading">#</a></h2>
<section id="select-feature">
<h3>Select Feature<a class="headerlink" href="#select-feature" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">selected_features</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-12-03</th>
      <td>7600</td>
      <td>7550</td>
      <td>7725</td>
      <td>7550</td>
    </tr>
    <tr>
      <th>2018-12-04</th>
      <td>7650</td>
      <td>7575</td>
      <td>7650</td>
      <td>7550</td>
    </tr>
    <tr>
      <th>2018-12-05</th>
      <td>7575</td>
      <td>7600</td>
      <td>7600</td>
      <td>7525</td>
    </tr>
    <tr>
      <th>2018-12-06</th>
      <td>7475</td>
      <td>7400</td>
      <td>7525</td>
      <td>7400</td>
    </tr>
    <tr>
      <th>2018-12-07</th>
      <td>7500</td>
      <td>7575</td>
      <td>7625</td>
      <td>7475</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-02</th>
      <td>6000</td>
      <td>6175</td>
      <td>6250</td>
      <td>5975</td>
    </tr>
    <tr>
      <th>2024-12-03</th>
      <td>6275</td>
      <td>6100</td>
      <td>6275</td>
      <td>6100</td>
    </tr>
    <tr>
      <th>2024-12-04</th>
      <td>6375</td>
      <td>6275</td>
      <td>6450</td>
      <td>6225</td>
    </tr>
    <tr>
      <th>2024-12-05</th>
      <td>6150</td>
      <td>6350</td>
      <td>6375</td>
      <td>6150</td>
    </tr>
    <tr>
      <th>2024-12-06</th>
      <td>6225</td>
      <td>6200</td>
      <td>6275</td>
      <td>6125</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">normalize_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
    <span class="n">normalized_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    <span class="n">csv</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
        <span class="s1">&#39;Open&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
        <span class="s1">&#39;normalized_Pembukaan&#39;</span><span class="p">:</span> <span class="n">normalized_data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        
    <span class="p">}</span>
    <span class="n">csv</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">csv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">normalized_data</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">csv</span>


<span class="n">normalized_df</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">csv_normalized</span> <span class="o">=</span> <span class="n">normalize_data</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">csv_normalized</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;normalized_data.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="s1">&#39;scaler.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;scaler.pkl&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normalized_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2018-12-03</th>
      <td>0.896714</td>
      <td>0.887324</td>
      <td>0.915094</td>
      <td>0.896226</td>
    </tr>
    <tr>
      <th>2018-12-04</th>
      <td>0.906103</td>
      <td>0.892019</td>
      <td>0.900943</td>
      <td>0.896226</td>
    </tr>
    <tr>
      <th>2018-12-05</th>
      <td>0.892019</td>
      <td>0.896714</td>
      <td>0.891509</td>
      <td>0.891509</td>
    </tr>
    <tr>
      <th>2018-12-06</th>
      <td>0.873239</td>
      <td>0.859155</td>
      <td>0.877358</td>
      <td>0.867925</td>
    </tr>
    <tr>
      <th>2018-12-07</th>
      <td>0.877934</td>
      <td>0.892019</td>
      <td>0.896226</td>
      <td>0.882075</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-02</th>
      <td>0.596244</td>
      <td>0.629108</td>
      <td>0.636792</td>
      <td>0.599057</td>
    </tr>
    <tr>
      <th>2024-12-03</th>
      <td>0.647887</td>
      <td>0.615023</td>
      <td>0.641509</td>
      <td>0.622642</td>
    </tr>
    <tr>
      <th>2024-12-04</th>
      <td>0.666667</td>
      <td>0.647887</td>
      <td>0.674528</td>
      <td>0.646226</td>
    </tr>
    <tr>
      <th>2024-12-05</th>
      <td>0.624413</td>
      <td>0.661972</td>
      <td>0.660377</td>
      <td>0.632075</td>
    </tr>
    <tr>
      <th>2024-12-06</th>
      <td>0.638498</td>
      <td>0.633803</td>
      <td>0.641509</td>
      <td>0.627358</td>
    </tr>
  </tbody>
</table>
<p>1460 rows × 4 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">denormalize_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scaler</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Harga Saham BMRI&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Harga dalam rupiah&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tahun&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">([</span><span class="s2">&quot;#2419ef&quot;</span><span class="p">,</span> <span class="s2">&quot;#19c4ef&quot;</span><span class="p">,</span> <span class="s2">&quot;#EF5919&quot;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">normalized_df</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6abf8c307f74f8889c848c8ddcf28f7e7f7ca18f1d0c0b2ecb9a2acd88a50520.png" src="_images/6abf8c307f74f8889c848c8ddcf28f7e7f7ca18f1d0c0b2ecb9a2acd88a50520.png" />
</div>
</div>
</section>
<section id="create-data-lag">
<h3>Create Data Lag<a class="headerlink" href="#create-data-lag" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sliding_windows</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">lagged_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">lagged_data</span><span class="p">[[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_lag</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>
    <span class="n">lagged_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lagged_data</span>

<span class="n">lags</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">12</span>
<span class="n">windowed_data</span> <span class="o">=</span> <span class="n">sliding_windows</span><span class="p">(</span><span class="n">normalized_df</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span>

<span class="n">windowed_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./lagged_data.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
C:\Users\ariek\AppData\Local\Temp\ipykernel_44604\1057553649.py:4: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  lagged_data[[f&quot;{col}_lag{lag}&quot; for col in data.columns]] = data.shift(lag)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">windowed_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Price</th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Price_lag1</th>
      <th>Open_lag1</th>
      <th>High_lag1</th>
      <th>Low_lag1</th>
      <th>Price_lag2</th>
      <th>Open_lag2</th>
      <th>...</th>
      <th>High_lag358</th>
      <th>Low_lag358</th>
      <th>Price_lag359</th>
      <th>Open_lag359</th>
      <th>High_lag359</th>
      <th>Low_lag359</th>
      <th>Price_lag360</th>
      <th>Open_lag360</th>
      <th>High_lag360</th>
      <th>Low_lag360</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-05-27</th>
      <td>0.241315</td>
      <td>0.248826</td>
      <td>0.250000</td>
      <td>0.228302</td>
      <td>0.239437</td>
      <td>0.245070</td>
      <td>0.242453</td>
      <td>0.237736</td>
      <td>0.233803</td>
      <td>0.192488</td>
      <td>...</td>
      <td>0.891509</td>
      <td>0.891509</td>
      <td>0.906103</td>
      <td>0.892019</td>
      <td>0.900943</td>
      <td>0.896226</td>
      <td>0.896714</td>
      <td>0.887324</td>
      <td>0.915094</td>
      <td>0.896226</td>
    </tr>
    <tr>
      <th>2020-05-28</th>
      <td>0.275117</td>
      <td>0.248826</td>
      <td>0.276415</td>
      <td>0.254717</td>
      <td>0.241315</td>
      <td>0.248826</td>
      <td>0.250000</td>
      <td>0.228302</td>
      <td>0.239437</td>
      <td>0.245070</td>
      <td>...</td>
      <td>0.877358</td>
      <td>0.867925</td>
      <td>0.892019</td>
      <td>0.896714</td>
      <td>0.891509</td>
      <td>0.891509</td>
      <td>0.906103</td>
      <td>0.892019</td>
      <td>0.900943</td>
      <td>0.896226</td>
    </tr>
    <tr>
      <th>2020-05-29</th>
      <td>0.308920</td>
      <td>0.275117</td>
      <td>0.304717</td>
      <td>0.273585</td>
      <td>0.275117</td>
      <td>0.248826</td>
      <td>0.276415</td>
      <td>0.254717</td>
      <td>0.241315</td>
      <td>0.248826</td>
      <td>...</td>
      <td>0.896226</td>
      <td>0.882075</td>
      <td>0.873239</td>
      <td>0.859155</td>
      <td>0.877358</td>
      <td>0.867925</td>
      <td>0.892019</td>
      <td>0.896714</td>
      <td>0.891509</td>
      <td>0.891509</td>
    </tr>
    <tr>
      <th>2020-06-02</th>
      <td>0.337089</td>
      <td>0.323944</td>
      <td>0.399057</td>
      <td>0.326415</td>
      <td>0.308920</td>
      <td>0.275117</td>
      <td>0.304717</td>
      <td>0.273585</td>
      <td>0.275117</td>
      <td>0.248826</td>
      <td>...</td>
      <td>0.877358</td>
      <td>0.858491</td>
      <td>0.877934</td>
      <td>0.892019</td>
      <td>0.896226</td>
      <td>0.882075</td>
      <td>0.873239</td>
      <td>0.859155</td>
      <td>0.877358</td>
      <td>0.867925</td>
    </tr>
    <tr>
      <th>2020-06-03</th>
      <td>0.382160</td>
      <td>0.346479</td>
      <td>0.391509</td>
      <td>0.337736</td>
      <td>0.337089</td>
      <td>0.323944</td>
      <td>0.399057</td>
      <td>0.326415</td>
      <td>0.308920</td>
      <td>0.275117</td>
      <td>...</td>
      <td>0.867925</td>
      <td>0.867925</td>
      <td>0.863850</td>
      <td>0.854460</td>
      <td>0.877358</td>
      <td>0.858491</td>
      <td>0.877934</td>
      <td>0.892019</td>
      <td>0.896226</td>
      <td>0.882075</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2024-12-02</th>
      <td>0.596244</td>
      <td>0.629108</td>
      <td>0.636792</td>
      <td>0.599057</td>
      <td>0.624413</td>
      <td>0.657277</td>
      <td>0.660377</td>
      <td>0.627358</td>
      <td>0.680751</td>
      <td>0.661972</td>
      <td>...</td>
      <td>0.415094</td>
      <td>0.415094</td>
      <td>0.417840</td>
      <td>0.417840</td>
      <td>0.419811</td>
      <td>0.405660</td>
      <td>0.422535</td>
      <td>0.427230</td>
      <td>0.429245</td>
      <td>0.429245</td>
    </tr>
    <tr>
      <th>2024-12-03</th>
      <td>0.647887</td>
      <td>0.615023</td>
      <td>0.641509</td>
      <td>0.622642</td>
      <td>0.596244</td>
      <td>0.629108</td>
      <td>0.636792</td>
      <td>0.599057</td>
      <td>0.624413</td>
      <td>0.657277</td>
      <td>...</td>
      <td>0.415094</td>
      <td>0.415094</td>
      <td>0.413146</td>
      <td>0.408451</td>
      <td>0.415094</td>
      <td>0.415094</td>
      <td>0.417840</td>
      <td>0.417840</td>
      <td>0.419811</td>
      <td>0.405660</td>
    </tr>
    <tr>
      <th>2024-12-04</th>
      <td>0.666667</td>
      <td>0.647887</td>
      <td>0.674528</td>
      <td>0.646226</td>
      <td>0.647887</td>
      <td>0.615023</td>
      <td>0.641509</td>
      <td>0.622642</td>
      <td>0.596244</td>
      <td>0.629108</td>
      <td>...</td>
      <td>0.424528</td>
      <td>0.415094</td>
      <td>0.413146</td>
      <td>0.408451</td>
      <td>0.415094</td>
      <td>0.415094</td>
      <td>0.413146</td>
      <td>0.408451</td>
      <td>0.415094</td>
      <td>0.415094</td>
    </tr>
    <tr>
      <th>2024-12-05</th>
      <td>0.624413</td>
      <td>0.661972</td>
      <td>0.660377</td>
      <td>0.632075</td>
      <td>0.666667</td>
      <td>0.647887</td>
      <td>0.674528</td>
      <td>0.646226</td>
      <td>0.647887</td>
      <td>0.615023</td>
      <td>...</td>
      <td>0.424528</td>
      <td>0.424528</td>
      <td>0.431925</td>
      <td>0.413146</td>
      <td>0.424528</td>
      <td>0.415094</td>
      <td>0.413146</td>
      <td>0.408451</td>
      <td>0.415094</td>
      <td>0.415094</td>
    </tr>
    <tr>
      <th>2024-12-06</th>
      <td>0.638498</td>
      <td>0.633803</td>
      <td>0.641509</td>
      <td>0.627358</td>
      <td>0.624413</td>
      <td>0.661972</td>
      <td>0.660377</td>
      <td>0.632075</td>
      <td>0.666667</td>
      <td>0.647887</td>
      <td>...</td>
      <td>0.433962</td>
      <td>0.424528</td>
      <td>0.427230</td>
      <td>0.427230</td>
      <td>0.424528</td>
      <td>0.424528</td>
      <td>0.431925</td>
      <td>0.413146</td>
      <td>0.424528</td>
      <td>0.415094</td>
    </tr>
  </tbody>
</table>
<p>1100 rows × 1444 columns</p>
</div></div></div>
</div>
</section>
<section id="split-data">
<h3>Split Data<a class="headerlink" href="#split-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_df</span> <span class="o">=</span> <span class="n">windowed_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">])</span>
<span class="n">target_df</span> <span class="o">=</span> <span class="n">windowed_data</span><span class="p">[[</span><span class="s1">&#39;Open&#39;</span><span class="p">]]</span>

<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">input_df</span><span class="p">,</span> <span class="n">target_df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_train shape:&quot;</span><span class="p">,</span> <span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_train shape:&quot;</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_test shape:&quot;</span><span class="p">,</span> <span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_test shape:&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X_train shape: (880, 1440)
y_train shape: (880, 1)
X_test shape: (220, 1440)
y_test shape: (220, 1)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modelling">
<h2>Modelling<a class="headerlink" href="#modelling" title="Link to this heading">#</a></h2>
<section id="modelling-data">
<h3>Modelling Data<a class="headerlink" href="#modelling-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linear_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="c1"># linear_model.fit(x_train, y_train)</span>

<span class="n">bagging_model</span> <span class="o">=</span> <span class="n">BaggingRegressor</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LinearRegression</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bagging_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dump</span><span class="p">(</span><span class="n">linear_model</span><span class="p">,</span> <span class="s1">&#39;bagging_linear.lib&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;bagging_linear.lib&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Squared Error (MSE): </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Error (MAE): </span><span class="si">{</span><span class="n">mae</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean Absolute Percentage Error (MAPE): </span><span class="si">{</span><span class="n">mape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;R-squared (R2): </span><span class="si">{</span><span class="n">r2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Squared Error (MSE): 0.0005328922003830839
Mean Absolute Error (MAE): 0.01783497814157956
Mean Absolute Percentage Error (MAPE): 0.1530976202930543
R-squared (R2): 0.9913563515789966
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Actual&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bagging_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicted&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Actual vs Predicted Over Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time Steps&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f850bdadc030d8db392d6f493df4ca99aae421e478529beff4c09142a8ff687.png" src="_images/1f850bdadc030d8db392d6f493df4ca99aae421e478529beff4c09142a8ff687.png" />
</div>
</div>
</section>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">multistep_forecast</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">):</span>
  <span class="n">forecast</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">last_observation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
  
  <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
    <span class="n">next_step</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">last_observation</span><span class="p">)</span>
    <span class="n">forecast</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_step</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Update the last observation with the new prediction</span>
    <span class="n">last_observation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">last_observation</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">last_observation</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_step</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  
  <span class="k">return</span> <span class="n">forecast</span>

<span class="c1"># Number of steps to forecast</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">12</span>

<span class="c1"># Perform the forecast</span>
<span class="n">forecasted_values</span> <span class="o">=</span> <span class="n">multistep_forecast</span><span class="p">(</span><span class="n">bagging_model</span><span class="p">,</span> <span class="n">input_df</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">forecasted_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.6344580300225532, 0.6691431920635376, 0.6616149718151106, 0.6681111617641186, 0.6717497598508195, 0.6360661063400643, 0.6504420124403736, 0.6468009140970382, 0.6409956119856364, 0.5993930331033015, 0.6312442080125694, 0.6366108070956911, 0.61148090385364, 0.6050616514632483, 0.6270969956030946, 0.6391250223434254, 0.6169530872855195, 0.6415522661052576, 0.6636745779663471, 0.6175541379485393, 0.6687589110748635, 0.6572567159976426, 0.6742770208649586, 0.694842660118986, 0.6735160590125402, 0.6977542142403155, 0.6884870480666675, 0.6813186844446086, 0.6968354959497252, 0.6480566331161037, 0.6690143642968388, 0.6656559074355921, 0.6541850811273071, 0.6036812940740712, 0.6566426476698889, 0.6442923684751625, 0.6190807658143883, 0.6193992657113069, 0.64849270349425, 0.6428957822841087, 0.6373457571819858, 0.6571536560943682, 0.651997468084783, 0.6603410087977681, 0.654080635030307, 0.6775081846564532, 0.6820009762089491, 0.6746727813265909, 0.6686711406357196, 0.6699326113450984, 0.6994618279582296, 0.6834103097471153, 0.6806810057761017, 0.6655044721207, 0.6928711668163038, 0.6863347574610156, 0.6707071655977803, 0.6731253379654105, 0.6995539728006125, 0.7255909042246845, 0.6792313157508306, 0.6952346851518394, 0.7027259248024549, 0.7401886535132374, 0.6885287551702465, 0.678078116815702, 0.6950201980506528, 0.6720904258216214, 0.6839486287667864, 0.6474343950191961, 0.6964596620871721, 0.6637733400403333, 0.6681058662670278, 0.6765858181704059, 0.6974325001602427, 0.6846593630386565, 0.6996146289495612, 0.7074762930260567, 0.7234278285179582, 0.728208463884176, 0.6997090141518975, 0.7704504391962592, 0.7695084608747987, 0.7538510303956306, 0.7632109922482933, 0.7532607976006979, 0.7728642243041267, 0.7439095667282828, 0.7348772469850633, 0.7177682690060224, 0.7400318479615394, 0.7205596091430102, 0.6988850734483302, 0.6889330411470638, 0.7150602397076304, 0.7007771752828809, 0.7174972050970819, 0.7225869057927925, 0.7344902381185539, 0.7360529088179665, 0.7245710248771283, 0.7069768058028632, 0.7393489069277623, 0.7284164166398627, 0.7238700263890729, 0.7198647185993492, 0.7705683280188939, 0.7771723014397655, 0.7689871630258629, 0.7856048522809768, 0.796940476611725, 0.7592322610581426, 0.8016801716813989, 0.772305780756657, 0.7892524881265552, 0.7936608008383295, 0.7715689284444903, 0.7818939598485117, 0.8147863918677257, 0.7970812449413434, 0.7926889300322353, 0.8102648373188953, 0.793878447295542, 0.8005921747327599, 0.783437645695642, 0.81383130945826, 0.8070813059266709, 0.8342493855953697, 0.8055875984128197, 0.8338355152436232, 0.8414926918264958, 0.8241688697591971, 0.8265942159282679, 0.863825435676112, 0.8636374160190732, 0.8349376748753188, 0.83678931916276, 0.8013244820360709, 0.8288095907368729, 0.8219414988352147, 0.780487463602839, 0.7818089124747923, 0.7849362856480253, 0.7796803107678306, 0.7736379401517399, 0.7836730475918326, 0.7675687210951156, 0.7666419914745967, 0.7675555518173808, 0.7765283017676492, 0.7877792158644377, 0.7940447094202541, 0.7772488889625611, 0.8031600929838117, 0.7950713855534036, 0.798971090568565, 0.7955129689474587, 0.7617905106383749, 0.7788985580792354, 0.7948741014996115, 0.7544941004430646, 0.7533445030123644, 0.7599571351414085, 0.7774637748207547, 0.7497949501208572, 0.7410177076530196, 0.7863363627289659, 0.761474098302365, 0.74593252281993, 0.7799553515389133, 0.8136438786393819, 0.7877841884050212, 0.7829996216164169, 0.7996412734081554, 0.7874818755476085, 0.7735185370153205, 0.7874779520776025, 0.7892582901722618, 0.7992010563846634, 0.8036329043812307, 0.7872556097311485, 0.8087393175423736, 0.8067246784714128, 0.7963070505439095, 0.8108344217207404, 0.8090611622443921, 0.8047538208876202, 0.7990762346225903, 0.7834490157516469, 0.8104413521468572, 0.8184317825126445, 0.8173823651074551, 0.7993720936288136, 0.8003545751779256, 0.8158965024337251, 0.8300455579430198, 0.7949601645028508, 0.8031325789782287, 0.8446670742892095, 0.8428357899893238, 0.8101146564335351, 0.8219472296601787, 0.824754701246911, 0.8302233135968872, 0.8296563383207815, 0.8284572907456426, 0.8394944221729854, 0.8447863490508319, 0.8572791713159961, 0.8427088564385253, 0.8544559775894485, 0.8791502295863464, 0.8695310765472513, 0.8724219156029339, 0.8576420117789375, 0.9039143497755167, 0.8749126292096265, 0.8544979879370845, 0.879164282322445, 0.8850408853026895, 0.8610738432160571, 0.867078779435667, 0.8621279157884478, 0.8797339833628165, 0.8431414979482477, 0.8394576891616292, 0.8655230264696901, 0.8521392082904888, 0.8268654746295357, 0.8687619451666915, 0.8609596691130303, 0.8751370336263237, 0.8548904826431866, 0.8519572200655477, 0.8668348645719931, 0.8477888401322005, 0.8525644760779126, 0.8493474204777933, 0.8654662874340185, 0.8591686207238908, 0.8324558514331447, 0.8278505429834163, 0.8341110558812573, 0.838977753418617, 0.8255777718670657, 0.831372954323708, 0.8412404547465537, 0.8540032569793542, 0.827075212413549, 0.830539078513597, 0.8522385700969065, 0.8730131842146147, 0.8379441148646956, 0.8362119062659766, 0.8252380273427775, 0.8530790956287555, 0.8225401701433563, 0.7917071412783366, 0.8291569815115218, 0.831095324062026, 0.8239353661483116, 0.8345722545269614, 0.8316050564335781, 0.8076337375177112, 0.8270321060098457, 0.8218521327146212, 0.8150574900774381, 0.8105786145503331, 0.8022458675734876, 0.7963050571957401, 0.8429157679682889, 0.841507045392932, 0.8114812587199439, 0.8775024458368615, 0.8506467291633766, 0.8334171601745072, 0.8500405911675543, 0.8123361331466529, 0.8220215897045349, 0.8026644850937091, 0.7828067333201492, 0.7716439096423697, 0.7929631388517728, 0.8043015738885737, 0.7795925290138915, 0.7811375521351634, 0.799836006264767, 0.7944364355412149, 0.7897863835684932, 0.8029417584831845, 0.7972432713245192, 0.8095469261559213, 0.7808108836841902, 0.8169173207107463, 0.8374545814899702, 0.8301222858170996, 0.8332145378996245, 0.8699713332528772, 0.8562404893893654, 0.8576609262564336, 0.8466417649316387, 0.8299893215101127, 0.8362196128222894, 0.8479924838287183, 0.8342306984499922, 0.8089326478206524, 0.8377331404552412, 0.8164600133442237, 0.7858188354388176, 0.808882969223426, 0.8184768431295422, 0.8201630743060098, 0.8046699329534286, 0.8130376640904755, 0.8178425732735046, 0.8224195134247371, 0.8099273177693496, 0.8358281260047741, 0.8048202273751479, 0.817157097750654, 0.8054593960577262, 0.7920177177027772, 0.8131013070989578, 0.7807241365608916, 0.7608474803272659, 0.7610870869633009, 0.7552860811628971, 0.780969866671358, 0.7550859009558605, 0.7550772738475257, 0.7656040115555451, 0.7762826173801316, 0.7490500477096829, 0.7874875417290232, 0.7802478945380221, 0.7683402107882301, 0.7596980143866232, 0.7423329452158575, 0.730837809795575, 0.7445847635434597, 0.7354035041476129, 0.712977063448523, 0.7321142056250713, 0.7429166471864795, 0.7028172929149794, 0.7384814866489695, 0.768103857445285, 0.7512762269166064, 0.7433909676596179, 0.7549415780909452, 0.7555815431108402, 0.7586256602988033, 0.7312395590402845, 0.7131472172734733, 0.7310501114496012, 0.7156108856911715, 0.6936131921021341, 0.6807654568609849, 0.7114879598001247, 0.7085705453750987]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
C:\Users\ariek\AppData\Local\Programs\Python\Python312\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but BaggingRegressor was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecasted_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecasted_values</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">dummy_columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">forecasted_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">forecasted_values_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">forecasted_values</span><span class="p">,</span> <span class="n">dummy_columns</span><span class="p">])</span>


<span class="n">forecasted_values_inverse_full</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">forecasted_values_full</span><span class="p">)</span>

<span class="n">forecasted_values_inverse</span> <span class="o">=</span> <span class="n">forecasted_values_inverse_full</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">combined_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y_test</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">forecasted_values_inverse</span><span class="p">])</span>

<span class="n">freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">time_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">forecasted_values_inverse</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Past Data&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">forecasted_values_inverse</span><span class="p">)],</span> <span class="n">forecasted_values_inverse</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecasted Values&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;All Past Data and Forecasted Future Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d343e102d24c0658265f349c87085ee20b9b308cd9f78f3724a2c290fcf0b33.png" src="_images/7d343e102d24c0658265f349c87085ee20b9b308cd9f78f3724a2c290fcf0b33.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">infer_freq</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">time_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">forecasted_values_inverse</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freq</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">combined_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">time_index</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">forecasted_values_inverse</span><span class="p">)]]),</span>
    <span class="s1">&#39;Open&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">],</span> <span class="n">forecasted_values_inverse</span><span class="p">])</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           Date         Open
0    2018-12-03  7550.000000
1    2018-12-04  7575.000000
2    2018-12-05  7600.000000
3    2018-12-06  7400.000000
4    2018-12-07  7575.000000
...         ...          ...
1815 2025-11-27  6635.627966
1816 2025-11-28  6518.490248
1817 2025-11-29  6450.076058
1818 2025-11-30  6613.673386
1819 2025-12-01  6598.138154

[1820 rows x 2 columns]
</pre></div>
</div>
</div>
</div>
</section>
<section id="deploy">
<h2>Deploy<a class="headerlink" href="#deploy" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://huggingface.co/spaces/Rieko00/BMRI_mult">https://huggingface.co/spaces/Rieko00/BMRI_mult</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Saham_uni.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Project 2 Prediksi Saham Univariate</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-library">Import Library</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda">EDA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#info-data">Info Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#null-value">Null Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-date-format">Set date format</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-data">Histogram Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot-data">Boxplot Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#corellation-matrix">Corellation Matrix</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepocessing">Prepocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select-feature">Select Feature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-data-lag">Create Data Lag</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#split-data">Split Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling-data">Modelling Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing">Testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy">Deploy</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Moch. Ariek Budianto
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>